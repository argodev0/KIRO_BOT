# Security-specific location blocks for Nginx

# Block access to sensitive files
location ~ /\. {
    deny all;
    access_log off;
    log_not_found off;
}

# Block access to backup files
location ~ ~$ {
    deny all;
    access_log off;
    log_not_found off;
}

# Block access to configuration files
location ~* \.(conf|config|ini|log|bak|backup|old|tmp)$ {
    deny all;
    access_log off;
    log_not_found off;
}

# Block access to version control
location ~ /\.(git|svn|hg|bzr) {
    deny all;
    access_log off;
    log_not_found off;
}

# Block access to common attack vectors
location ~* \.(php|asp|aspx|jsp|cgi|pl|py)$ {
    deny all;
    access_log off;
    log_not_found off;
}

# Security headers for all responses
location ~* \.(js|css|png|jpg|jpeg|gif|ico|svg|woff|woff2|ttf|eot|webp|avif)$ {
    add_header X-Paper-Trading-Mode "true" always;
    add_header X-Content-Type-Options "nosniff" always;
    add_header X-Frame-Options "DENY" always;
}